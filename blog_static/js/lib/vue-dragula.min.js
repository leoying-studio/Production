/*!
 * vue-dragula v1.0.5
 * (c) 2016 Yichang Liu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("dragula")):"function"==typeof define&&define.amd?define(["dragula"],n):e.vueDragula=n(e.dragula)}(this,function(e){"use strict";function n(n){var a=new t(n),i="globalBag",o=void 0;n.vueDragula={options:a.setOptions.bind(a),eventBus:a.eventBus},n.directive("dragula",{params:["bag"],bind:function(){var n=this.el,t=this.params.bag;void 0!==t&&0!==t.length&&(i=t);var r=a.find(i);return r?(o=r.drake,void o.containers.push(n)):(o=e({containers:[n]}),a.add(i,o),void a.handleModels(i,o))},update:function(e,n){if(e)if(o.models){var a=n?o.models.indexOf(n):-1;a>=0?o.models.splice(a,1,e):o.models.push(e)}else o.models=[e]},unbind:function(){var e=this.el,n="globalBag",i=this.params.bag;void 0!==i&&0!==i.length&&(n=i);var t=a.find(n).drake;if(t){var o=t.containers.indexOf(e);o>-1&&t.containers.splice(o,1),0===t.containers.length&&a.destroy(n)}}})}function a(e){arguments.length<=1||void 0===arguments[1]?{}:arguments[1];a.installed&&console.warn("[vue-dragula] already installed."),n(e)}e="default"in e?e["default"]:e;var i={};if(i.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},i.createClass=function(){function e(e,n){for(var a=0;a<n.length;a++){var i=n[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,a,i){return a&&e(n.prototype,a),i&&e(n,i),n}}(),!e)throw new Error("[vue-dragula] cannot locate dragula.");var t=function(){function n(e){i.classCallCheck(this,n),this.bags=[],this.eventBus=new e,this.events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","dropModel","removeModel"]}return i.createClass(n,[{key:"add",value:function(e,n){var a=this.find(e);if(a)throw new Error('Bag named: "'+e+'" already exists.');return a={name:e,drake:n},this.bags.push(a),n.models&&this.handleModels(e,n),a.initEvents||this.setupEvents(a),a}},{key:"find",value:function(e){for(var n=this.bags,a=0;a<n.length;a++)if(n[a].name===e)return n[a]}},{key:"handleModels",value:function(e,n){var a=this;if(!n.registered){var i=void 0,t=void 0,o=void 0,r=void 0;n.on("remove",function(i,o,s){n.models&&(r=n.models[n.containers.indexOf(s)],r.splice(t,1),n.cancel(!0),a.eventBus.$emit("removeModel",[e,i,s]))}),n.on("drag",function(e,n){i=e,t=a.domIndexOf(e,n)}),n.on("drop",function(s,d,l){if(n.models&&d){if(o=a.domIndexOf(s,d),r=n.models[n.containers.indexOf(l)],d===l)r.splice(o,0,r.splice(t,1)[0]);else{var u=i===s,c=n.models[n.containers.indexOf(d)],f=u?r[t]:JSON.parse(JSON.stringify(r[t]));u&&r.splice(t,1),c.splice(o,0,f),n.cancel(!0)}a.eventBus.$emit("dropModel",[e,s,d,l])}}),n.registered=!0}}},{key:"destroy",value:function(e){var n=this.find(e);if(n){var a=this.bags.indexOf(n);this.bags.splice(a,1),n.drake.destroy()}}},{key:"setOptions",value:function(n,a){var i=this.add(n,e(a));this.handleModels(n,i.drake)}},{key:"setupEvents",value:function(e){e.initEvents=!0;var n=this,a=function(a){function i(){var i=Array.prototype.slice.call(arguments);n.eventBus.$emit(a,[e.name].concat(i))}e.drake.on(a,i)};this.events.forEach(a)}},{key:"domIndexOf",value:function(e,n){return Array.prototype.indexOf.call(n.children,e)}}]),n}();if(!e)throw new Error("[vue-dragula] cannot locate dragula.");return a.version="1.0.0","function"==typeof define&&define.amd?define([],function(){}):window.Vue&&window.Vue.use(a),a});